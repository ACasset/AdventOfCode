<html>
    <head>
        <script type="text/javascript">
            let currentDate = new Date();
            
            function initYears() {
                for (var i = currentDate.getFullYear(); i >= 2015; i--) {
                    if (currentDate.getFullYear() == i && currentDate.getMonth() < 11)
                        continue;
                    
                    let year = document.createElement("option");
                    year.value = i;
                    year.text = i;
                    
                    document.getElementById("year").append(year);
                }
                
                document.getElementById("year").addEventListener("change", function(){ initDays(); });
                document.getElementById("year").dispatchEvent(new Event("change"));
            }
            
            function initDays() {
                while (document.getElementById("day").firstChild) {
                    document.getElementById("day").removeChild(document.getElementById("day").lastChild);
                }
            
                for (var i = 25; i >= 1; i--) {
                    if (currentDate.getFullYear() == document.getElementById("year").value && currentDate.getMonth() == 11 && currentDate.getDate() < i)
                        continue;
                    
                    let day = document.createElement("option");
                    day.value = ("" + i).padStart(2, '0');
                    day.text = ("" + i).padStart(2, '0');
                    
                    document.getElementById("day").append(day);
                }
            }
            
            function run() {
                let baseUrl = "https://raw.githubusercontent.com/ACasset/AdventOfCode/main/"
                let path = document.getElementById("year").value + "/day-" + document.getElementById("day").value + "/";

                let fullInputPath = baseUrl + path + "input-" + document.querySelector('input[name="input"]:checked').value + ".txt";

                let rawFile = new XMLHttpRequest();
                rawFile.open("GET", fullInputPath, true);
                rawFile.onreadystatechange = function () {
                    if (rawFile.readyState === 4){
                        if (rawFile.status === 200 || rawFile.status == 0) {
                            let script = document.createElement("script");

                            script.onload = function () {
                                document.getElementById("output").innerHTML = execute( rawFile.responseText );
                            };

                            script.src = document.getElementById("year").value + "/day-" + document.getElementById("day").value + "/" + "part-" + document.querySelector('input[name="part"]:checked').value + ".js";
                            document.head.appendChild(script);
                        }
                    }
                }
                rawFile.send(null);
            }
        </script>
    </head>
    <body style="text-align: center;" onload="javascript:initYears();">
        <div style="margin-top: 30px;">
            Year: <select id="year"><select><br />
            Day: <select id="day"></select><br />
            Part: <label><input id="part-one" type="radio" name="part" value="one" checked="checked" />one</label> <label><input id="part-two" type="radio" name="part" value="two" />two</label><br />
            Input: <label><input id="input-real" type="radio" name="input" value="real" checked="checked" />real</label> <label><input id="input-test" type="radio" name="input" value="test" />test</label><br />
            <input type="button" value="Run" onclick="javascript:run();" />
        </div>
        <div style="margin-top: 30px;">
            <span id="output"></span>
        </div>
    </body>
</html>